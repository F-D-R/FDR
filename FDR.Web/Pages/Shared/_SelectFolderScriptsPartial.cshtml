<script>

    $(function () {
        $('[data-bs-target="#FolderPopup"]').on('click', function (e) {
            $('#source').val("");
            let source = $(e.currentTarget).attr('id').replace(/select/i, "");
            $('#source').val(source);

            let folder = $('#' + source).val();
            $.ajax({ url: `/Folder/Folder?folder=${encodeURIComponent(folder)}`, type: 'GET', complete: function (res) { $('#SelectedFolder').val(res.responseText); } });
            $('#Drives').load(`/Folder/Drives?folder=${encodeURIComponent(folder)}`);
            $('#Subfolders').load(`/Folder/Subfolders?folder=${encodeURIComponent(folder)}`);
        });
    })

    $(function () {
        $('#SaveFolder').on('click', function () {
            $('#' + $('#source').val()).val($('#SelectedFolder').val());
            ClearFolderPopup();
        });
    })

    $(function () {
        $('#CancelFolder').on('click', function () {
            ClearFolderPopup();
        });
    })

    function ClearFolderPopup() {
            $('#SelectedFolder').val("");
            $('#Drives').val("");
            $('#Subfolders').val("");
            $('#Subfolders').empty();
    }

</script>
